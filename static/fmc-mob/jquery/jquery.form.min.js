(function(c){function m(){if(c.fn.ajaxSubmit.debug){var a="[jquery.form] "+Array.prototype.join.call(arguments,"");window.console&&window.console.log?window.console.log(a):window.opera&&window.opera.postError&&window.opera.postError(a)}}c.fn.ajaxSubmit=function(a){function g(b){function g(){function a(){try{var b=(n.contentWindow?n.contentWindow.document:n.contentDocument?n.contentDocument:n.document).readyState;m("state = "+b);"uninitialized"==b.toLowerCase()&&setTimeout(a,50)}catch(c){m("Server abort: ",
c," (",c.name,")"),k(v),s&&clearTimeout(s),s=void 0}}var b=h.attr("target"),f=h.attr("action");e.setAttribute("target",p);j||e.setAttribute("method","POST");f!=d.url&&e.setAttribute("action",d.url);!d.skipEncodingOverride&&(!j||/post/i.test(j))&&h.attr({encoding:"multipart/form-data",enctype:"multipart/form-data"});d.timeout&&(s=setTimeout(function(){t=!0;k(x)},d.timeout));var i=[];try{if(d.extraData)for(var l in d.extraData)i.push(c('<input type="hidden" name="'+l+'" />').attr("value",d.extraData[l]).appendTo(e)[0]);
d.iframeTarget||(q.appendTo("body"),n.attachEvent?n.attachEvent("onload",k):n.addEventListener("load",k,!1));setTimeout(a,15);e.submit()}finally{e.setAttribute("action",f),b?e.setAttribute("target",b):h.removeAttr("target"),c(i).remove()}}function k(a){if(!f.aborted&&!y){try{o=n.contentWindow?n.contentWindow.document:n.contentDocument?n.contentDocument:n.document}catch(b){m("cannot access response document: ",b),a=v}if(a===x&&f)f.abort("timeout");else if(a==v&&f)f.abort("server abort");else if(o&&
o.location.href!=d.iframeSrc||t){n.detachEvent?n.detachEvent("onload",k):n.removeEventListener("load",k,!1);var a="success",e;try{if(t)throw"timeout";var h="xml"==d.dataType||o.XMLDocument||c.isXMLDoc(o);m("isXml="+h);if(!h&&window.opera&&(null==o.body||""==o.body.innerHTML)&&--B){m("requeing onLoad callback, DOM not available");setTimeout(k,250);return}var g=o.body?o.body:o.documentElement;f.responseText=g?g.innerHTML:null;f.responseXML=o.XMLDocument?o.XMLDocument:o;if(h)d.dataType="xml";f.getResponseHeader=
function(a){return{"content-type":d.dataType}[a]};if(g)f.status=Number(g.getAttribute("status"))||f.status,f.statusText=g.getAttribute("statusText")||f.statusText;var i=(d.dataType||"").toLowerCase(),j=/(json|script|text)/.test(i);if(j||d.textarea){var l=o.getElementsByTagName("textarea")[0];if(l)f.responseText=l.value,f.status=Number(l.getAttribute("status"))||f.status,f.statusText=l.getAttribute("statusText")||f.statusText;else if(j){var p=o.getElementsByTagName("pre")[0],u=o.getElementsByTagName("body")[0];
if(p)f.responseText=p.textContent?p.textContent:p.innerText;else if(u)f.responseText=u.textContent?u.textContent:u.innerText}}else if("xml"==i&&!f.responseXML&&null!=f.responseText)f.responseXML=C(f.responseText);try{z=D(f,i,d)}catch(A){a="parsererror",f.error=e=A||a}}catch(w){m("error caught: ",w),a="error",f.error=e=w||a}f.aborted&&(m("upload aborted"),a=null);f.status&&(a=200<=f.status&&300>f.status||304===f.status?"success":"error");if("success"===a)d.success&&d.success.call(d.context,z,"success",
f),r&&c.event.trigger("ajaxSuccess",[f,d]);else if(a){if(void 0==e)e=f.statusText;d.error&&d.error.call(d.context,f,a,e);r&&c.event.trigger("ajaxError",[f,d,e])}r&&c.event.trigger("ajaxComplete",[f,d]);r&&!--c.active&&c.event.trigger("ajaxStop");d.complete&&d.complete.call(d.context,f,a);y=!0;d.timeout&&clearTimeout(s);setTimeout(function(){d.iframeTarget||q.remove();f.responseXML=null},100)}}}var e=h[0],i,l,d,r,p,q,n,f,t,s;i=!!c.fn.prop;if(b)if(i)for(l=0;l<b.length;l++)i=c(e[b[l].name]),i.prop("disabled",
!1);else for(l=0;l<b.length;l++)i=c(e[b[l].name]),i.removeAttr("disabled");if(c(":input[name=submit],:input[id=submit]",e).length)alert('Error: Form elements must not have name or id of "submit".');else if(d=c.extend(!0,{},c.ajaxSettings,a),d.context=d.context||d,p="jqFormIO"+(new Date).getTime(),d.iframeTarget?(q=c(d.iframeTarget),i=q.attr("name"),null==i?q.attr("name",p):p=i):(q=c('<iframe name="'+p+'" src="'+d.iframeSrc+'" />'),q.css({position:"absolute",top:"-1000px",left:"-1000px"})),n=q[0],
f={aborted:0,responseText:null,responseXML:null,status:0,statusText:"n/a",getAllResponseHeaders:function(){},getResponseHeader:function(){},setRequestHeader:function(){},abort:function(a){var b="timeout"===a?"timeout":"aborted";m("aborting upload... "+b);this.aborted=1;q.attr("src",d.iframeSrc);f.error=b;d.error&&d.error.call(d.context,f,b,a);r&&c.event.trigger("ajaxError",[f,d,b]);d.complete&&d.complete.call(d.context,f,b)}},(r=d.global)&&!c.active++&&c.event.trigger("ajaxStart"),r&&c.event.trigger("ajaxSend",
[f,d]),d.beforeSend&&!1===d.beforeSend.call(d.context,f,d))d.global&&c.active--;else if(!f.aborted){if(b=e.clk)if((i=b.name)&&!b.disabled)if(d.extraData=d.extraData||{},d.extraData[i]=b.value,"image"==b.type)d.extraData[i+".x"]=e.clk_x,d.extraData[i+".y"]=e.clk_y;var x=1,v=2;d.forceSync?g():setTimeout(g,10);var z,o,B=50,y,C=c.parseXML||function(a,b){window.ActiveXObject?(b=new ActiveXObject("Microsoft.XMLDOM"),b.async="false",b.loadXML(a)):b=(new DOMParser).parseFromString(a,"text/xml");return b&&
b.documentElement&&"parsererror"!=b.documentElement.nodeName?b:null},E=c.parseJSON||function(a){return window.eval("("+a+")")},D=function(a,b,d){var e=a.getResponseHeader("content-type")||"",f="xml"===b||!b&&0<=e.indexOf("xml"),a=f?a.responseXML:a.responseText;f&&"parsererror"===a.documentElement.nodeName&&c.error&&c.error("parsererror");d&&d.dataFilter&&(a=d.dataFilter(a,b));"string"===typeof a&&("json"===b||!b&&0<=e.indexOf("json")?a=E(a):("script"===b||!b&&0<=e.indexOf("javascript"))&&c.globalEval(a));
return a}}}if(!this.length)return m("ajaxSubmit: skipping submit process - no element selected"),this;var j,b,h=this;"function"==typeof a&&(a={success:a});j=this.attr("method");b=this.attr("action");(b=(b="string"===typeof b?c.trim(b):"")||window.location.href||"")&&(b=(b.match(/^([^#]+)/)||[])[1]);a=c.extend(!0,{url:b,success:c.ajaxSettings.success,type:j||"GET",iframeSrc:/^https/i.test(window.location.href||"")?"javascript:false":"about:blank"},a);b={};this.trigger("form-pre-serialize",[this,a,
b]);if(b.veto)return m("ajaxSubmit: submit vetoed via form-pre-serialize trigger"),this;if(a.beforeSerialize&&!1===a.beforeSerialize(this,a))return m("ajaxSubmit: submit aborted via beforeSerialize callback"),this;var k=a.traditional;if(void 0===k)k=c.ajaxSettings.traditional;var e,i=this.formToArray(a.semantic);if(a.data)a.extraData=a.data,e=c.param(a.data,k);if(a.beforeSubmit&&!1===a.beforeSubmit(i,this,a))return m("ajaxSubmit: submit aborted via beforeSubmit callback"),this;this.trigger("form-submit-validate",
[i,this,a,b]);if(b.veto)return m("ajaxSubmit: submit vetoed via form-submit-validate trigger"),this;b=c.param(i,k);e&&(b=b?b+"&"+e:e);"GET"==a.type.toUpperCase()?(a.url+=(0<=a.url.indexOf("?")?"&":"?")+b,a.data=null):a.data=b;var l=[];a.resetForm&&l.push(function(){h.resetForm()});a.clearForm&&l.push(function(){h.clearForm(a.includeHidden)});if(!a.dataType&&a.target){var t=a.success||function(){};l.push(function(b){var e=a.replaceTarget?"replaceWith":"html";c(a.target)[e](b).each(t,arguments)})}else a.success&&
l.push(a.success);a.success=function(b,c,e){for(var g=a.context||a,i=0,k=l.length;i<k;i++)l[i].apply(g,[b,c,e||h,h])};e=0<c("input:file",this).length;b="multipart/form-data"==h.attr("enctype")||"multipart/form-data"==h.attr("encoding");if(!1!==a.iframe&&(e||a.iframe||b))a.closeKeepAlive?c.get(a.closeKeepAlive,function(){g(i)}):g(i);else{if(c.browser.msie&&"get"==j&&"undefined"===typeof a.type&&(e=h[0].getAttribute("method"),"string"===typeof e))a.type=e;c.ajax(a)}this.trigger("form-submit-notify",
[this,a]);return this};c.fn.ajaxForm=function(a){if(0===this.length){var g=this.selector,j=this.context;if(!c.isReady&&g)return m("DOM not ready, queuing ajaxForm"),c(function(){c(g,j).ajaxForm(a)}),this;m("terminating; zero elements found by selector"+(c.isReady?"":" (DOM not ready)"));return this}return this.ajaxFormUnbind().bind("submit.form-plugin",function(b){b.isDefaultPrevented()||(b.preventDefault(),c(this).ajaxSubmit(a))}).bind("click.form-plugin",function(a){var h=a.target,g=c(h);if(!g.is(":submit,input:image")){h=
g.closest(":submit");if(0==h.length)return;h=h[0]}var e=this;e.clk=h;if("image"==h.type)void 0!=a.offsetX?(e.clk_x=a.offsetX,e.clk_y=a.offsetY):"function"==typeof c.fn.offset?(g=g.offset(),e.clk_x=a.pageX-g.left,e.clk_y=a.pageY-g.top):(e.clk_x=a.pageX-h.offsetLeft,e.clk_y=a.pageY-h.offsetTop);setTimeout(function(){e.clk=e.clk_x=e.clk_y=null},100)})};c.fn.ajaxFormUnbind=function(){return this.unbind("submit.form-plugin click.form-plugin")};c.fn.formToArray=function(a){var g=[];if(0===this.length)return g;
var j=this[0],b=a?j.getElementsByTagName("*"):j.elements;if(!b)return g;var h,k,e,i,l,m;for(h=0,l=b.length;h<l;h++)if(k=b[h],e=k.name)if(a&&j.clk&&"image"==k.type)!k.disabled&&j.clk==k&&(g.push({name:e,value:c(k).val()}),g.push({name:e+".x",value:j.clk_x},{name:e+".y",value:j.clk_y}));else if((i=c.fieldValue(k,!0))&&i.constructor==Array)for(k=0,m=i.length;k<m;k++)g.push({name:e,value:i[k]});else null!==i&&"undefined"!=typeof i&&g.push({name:e,value:i});if(!a&&j.clk&&(a=c(j.clk),b=a[0],(e=b.name)&&
!b.disabled&&"image"==b.type))g.push({name:e,value:a.val()}),g.push({name:e+".x",value:j.clk_x},{name:e+".y",value:j.clk_y});return g};c.fn.formSerialize=function(a){return c.param(this.formToArray(a))};c.fn.fieldSerialize=function(a){var g=[];this.each(function(){var j=this.name;if(j){var b=c.fieldValue(this,a);if(b&&b.constructor==Array)for(var h=0,k=b.length;h<k;h++)g.push({name:j,value:b[h]});else null!==b&&"undefined"!=typeof b&&g.push({name:this.name,value:b})}});return c.param(g)};c.fn.fieldValue=
function(a){for(var g=[],j=0,b=this.length;j<b;j++){var h=c.fieldValue(this[j],a);null===h||"undefined"==typeof h||h.constructor==Array&&!h.length||(h.constructor==Array?c.merge(g,h):g.push(h))}return g};c.fieldValue=function(a,g){var j=a.name,b=a.type,h=a.tagName.toLowerCase();void 0===g&&(g=!0);if(g&&(!j||a.disabled||"reset"==b||"button"==b||("checkbox"==b||"radio"==b)&&!a.checked||("submit"==b||"image"==b)&&a.form&&a.form.clk!=a||"select"==h&&-1==a.selectedIndex))return null;if("select"==h){var k=
a.selectedIndex;if(0>k)return null;for(var j=[],h=a.options,e=(b="select-one"==b)?k+1:h.length,k=b?k:0;k<e;k++){var i=h[k];if(i.selected){var l=i.value;l||(l=i.attributes&&i.attributes.value&&!i.attributes.value.specified?i.text:i.value);if(b)return l;j.push(l)}}return j}return c(a).val()};c.fn.clearForm=function(a){return this.each(function(){c("input,select,textarea",this).clearFields(a)})};c.fn.clearFields=c.fn.clearInputs=function(a){var c=/^(?:color|date|datetime|email|month|number|password|range|search|tel|text|time|url|week)$/i;
return this.each(function(){var j=this.type,b=this.tagName.toLowerCase();if(c.test(j)||"textarea"==b||a&&/hidden/.test(j))this.value="";else if("checkbox"==j||"radio"==j)this.checked=!1;else if("select"==b)this.selectedIndex=-1})};c.fn.resetForm=function(){return this.each(function(){("function"==typeof this.reset||"object"==typeof this.reset&&!this.reset.nodeType)&&this.reset()})};c.fn.enable=function(a){void 0===a&&(a=!0);return this.each(function(){this.disabled=!a})};c.fn.selected=function(a){void 0===
a&&(a=!0);return this.each(function(){var g=this.type;if("checkbox"==g||"radio"==g)this.checked=a;else if("option"==this.tagName.toLowerCase())g=c(this).parent("select"),a&&g[0]&&"select-one"==g[0].type&&g.find("option").selected(!1),this.selected=a})};c.fn.ajaxSubmit.debug=!1})(jQuery);
